{
  "question_id" : 44825976,
  "title" : "Microsoft Graph sending a lot of unnecessary notifications for create/delete",
  "body" : "<p>For better efficiency we upgraded our system from polling over to using the webhooks subscriptions and delta queries.</p>\n\n<p>However, for the webhooks, I am finding we are getting a lot of unnecessary/spurious notifications.</p>\n\n<p>For example if a user cancels an event what we see are several <code>update</code> notifications followed by a single <code>deleted</code> notification, in a matter of milliseconds.</p>\n\n<p>This is quite annoying as it creates a situation where instead of being able to react to the notifications immediately (if the work queue is empty that is), we have had to add a throttle/debounce, so that we can get a more accurate reading from the webhooks.</p>\n\n<p>An example of a delete also incurring an update is as follows:</p>\n\n<pre><code>[2017-06-28T23:17:40.657Z][meetingroom1.outlookDidNotify] Received notification {\n  \"subscriptionId\": \"54c27b11-c2e2-4962-89dd-cf316bf3eecb\",\n  \"subscriptionExpirationDateTime\": \"2017-06-28T23:59:59.999+00:00\",\n  \"changeType\": \"updated\",\n  \"resource\": \"Users/f4a2ac63-ddf7-40dc-80da-4e05acf6488a/Events/AAMkADc1MWNjZWM3LTNhZDYtNGYwYi04OWYxLTU0N2E0MmI5YTE4MwBGAAAAAAAKhIOGniPIR6bsTEhp5zDzBwAPLFcVBl_pRZA4tM1jHR47AAAAAAENAAAPLFcVBl_pRZA4tM1jHR47AAD5gM31AAA=\",\n  \"resourceData\": {\n    \"@odata.type\": \"#Microsoft.Graph.Event\",\n    \"@odata.id\": \"Users/f4a2ac63-ddf7-40dc-80da-4e05acf6488a/Events/AAMkADc1MWNjZWM3LTNhZDYtNGYwYi04OWYxLTU0N2E0MmI5YTE4MwBGAAAAAAAKhIOGniPIR6bsTEhp5zDzBwAPLFcVBl_pRZA4tM1jHR47AAAAAAENAAAPLFcVBl_pRZA4tM1jHR47AAD5gM31AAA=\",\n    \"@odata.etag\": \"W/\\\"DwAAABYAAAAPLFcVBl+pRZA4tM1jHR47AAD+zvOL\\\"\",\n    \"id\": \"AAMkADc1MWNjZWM3LTNhZDYtNGYwYi04OWYxLTU0N2E0MmI5YTE4MwBGAAAAAAAKhIOGniPIR6bsTEhp5zDzBwAPLFcVBl_pRZA4tM1jHR47AAAAAAENAAAPLFcVBl_pRZA4tM1jHR47AAD5gM31AAA=\"\n  },\n  \"clientState\": \"…\"\n}\n[2017-06-28T23:17:40.658Z][meetingroom1.outlookDidNotify] Received notification {\n  \"subscriptionId\": \"54c27b11-c2e2-4962-89dd-cf316bf3eecb\",\n  \"subscriptionExpirationDateTime\": \"2017-06-28T23:59:59.999+00:00\",\n  \"changeType\": \"deleted\",\n  \"resource\": \"Users/f4a2ac63-ddf7-40dc-80da-4e05acf6488a/Events/AAMkADc1MWNjZWM3LTNhZDYtNGYwYi04OWYxLTU0N2E0MmI5YTE4MwBGAAAAAAAKhIOGniPIR6bsTEhp5zDzBwAPLFcVBl_pRZA4tM1jHR47AAAAAAENAAAPLFcVBl_pRZA4tM1jHR47AAD5gM31AAA=\",\n  \"resourceData\": {\n    \"@odata.type\": \"#Microsoft.Graph.Event\",\n    \"@odata.id\": \"Users/f4a2ac63-ddf7-40dc-80da-4e05acf6488a/Events/AAMkADc1MWNjZWM3LTNhZDYtNGYwYi04OWYxLTU0N2E0MmI5YTE4MwBGAAAAAAAKhIOGniPIR6bsTEhp5zDzBwAPLFcVBl_pRZA4tM1jHR47AAAAAAENAAAPLFcVBl_pRZA4tM1jHR47AAD5gM31AAA=\",\n    \"@odata.etag\": \"W/\\\"CQAAAA==\\\"\",\n    \"id\": \"AAMkADc1MWNjZWM3LTNhZDYtNGYwYi04OWYxLTU0N2E0MmI5YTE4MwBGAAAAAAAKhIOGniPIR6bsTEhp5zDzBwAPLFcVBl_pRZA4tM1jHR47AAAAAAENAAAPLFcVBl_pRZA4tM1jHR47AAD5gM31AAA=\"\n  },\n  \"clientState\": \"…\"\n}\n</code></pre>\n\n<p>Likewise sending multiple update notifications for the same event in a fraction of a second.</p>\n\n<p>Events that are created can be followed by several update events within a second:</p>\n\n<pre><code>[2017-06-28T15:57:45.044Z][meetingroom2.outlookDidNotify] Received notification {\n  \"subscriptionId\": \"de0147cc-cdef-4141-b601-4eb32cec1377\",\n  \"subscriptionExpirationDateTime\": \"2017-06-28T23:59:59.999+00:00\",\n  \"changeType\": \"created\",\n  \"resource\": \"Users/97e22591-9c20-4030-a11e-102ba89741fc/Events/AAMkADFlY2YyODZiLTc1OGItNGE1Yy1iNDI1LWNjMGQ5MDRjNDU2ZABGAAAAAACfo61cAY_iTZYbfhL-JgzZBwDlDV58cGeaS7ZJcZ6ff_AvAAAAAAENAADlDV58cGeaS7ZJcZ6ff_AvAAD9hgs0AAA=\",\n  \"resourceData\": {\n    \"@odata.type\": \"#Microsoft.Graph.Event\",\n    \"@odata.id\": \"Users/97e22591-9c20-4030-a11e-102ba89741fc/Events/AAMkADFlY2YyODZiLTc1OGItNGE1Yy1iNDI1LWNjMGQ5MDRjNDU2ZABGAAAAAACfo61cAY_iTZYbfhL-JgzZBwDlDV58cGeaS7ZJcZ6ff_AvAAAAAAENAADlDV58cGeaS7ZJcZ6ff_AvAAD9hgs0AAA=\",\n    \"@odata.etag\": \"W/\\\"DwAAABYAAADlDV58cGeaS7ZJcZ6ff+AvAAD9kqa/\\\"\",\n    \"id\": \"AAMkADFlY2YyODZiLTc1OGItNGE1Yy1iNDI1LWNjMGQ5MDRjNDU2ZABGAAAAAACfo61cAY_iTZYbfhL-JgzZBwDlDV58cGeaS7ZJcZ6ff_AvAAAAAAENAADlDV58cGeaS7ZJcZ6ff_AvAAD9hgs0AAA=\"\n  },\n  \"clientState\": \"…\"\n}\n[2017-06-28T15:57:45.954Z][meetingroom2.outlookDidNotify] Received notification {\n  \"subscriptionId\": \"de0147cc-cdef-4141-b601-4eb32cec1377\",\n  \"subscriptionExpirationDateTime\": \"2017-06-28T23:59:59.999+00:00\",\n  \"changeType\": \"updated\",\n  \"resource\": \"Users/97e22591-9c20-4030-a11e-102ba89741fc/Events/AAMkADFlY2YyODZiLTc1OGItNGE1Yy1iNDI1LWNjMGQ5MDRjNDU2ZABGAAAAAACfo61cAY_iTZYbfhL-JgzZBwDlDV58cGeaS7ZJcZ6ff_AvAAAAAAENAADlDV58cGeaS7ZJcZ6ff_AvAAD9hgs0AAA=\",\n  \"resourceData\": {\n    \"@odata.type\": \"#Microsoft.Graph.Event\",\n    \"@odata.id\": \"Users/97e22591-9c20-4030-a11e-102ba89741fc/Events/AAMkADFlY2YyODZiLTc1OGItNGE1Yy1iNDI1LWNjMGQ5MDRjNDU2ZABGAAAAAACfo61cAY_iTZYbfhL-JgzZBwDlDV58cGeaS7ZJcZ6ff_AvAAAAAAENAADlDV58cGeaS7ZJcZ6ff_AvAAD9hgs0AAA=\",\n    \"@odata.etag\": \"W/\\\"DwAAABYAAADlDV58cGeaS7ZJcZ6ff+AvAAD9kqa/\\\"\",\n    \"id\": \"AAMkADFlY2YyODZiLTc1OGItNGE1Yy1iNDI1LWNjMGQ5MDRjNDU2ZABGAAAAAACfo61cAY_iTZYbfhL-JgzZBwDlDV58cGeaS7ZJcZ6ff_AvAAAAAAENAADlDV58cGeaS7ZJcZ6ff_AvAAD9hgs0AAA=\"\n  },\n  \"clientState\": \"…\"\n}\n[2017-06-28T15:57:47.409Z][meetingroom2.outlookDidNotify] Received notification {\n  \"subscriptionId\": \"de0147cc-cdef-4141-b601-4eb32cec1377\",\n  \"subscriptionExpirationDateTime\": \"2017-06-28T23:59:59.999+00:00\",\n  \"changeType\": \"updated\",\n  \"resource\": \"Users/97e22591-9c20-4030-a11e-102ba89741fc/Events/AAMkADFlY2YyODZiLTc1OGItNGE1Yy1iNDI1LWNjMGQ5MDRjNDU2ZABGAAAAAACfo61cAY_iTZYbfhL-JgzZBwDlDV58cGeaS7ZJcZ6ff_AvAAAAAAENAADlDV58cGeaS7ZJcZ6ff_AvAAD9hgs0AAA=\",\n  \"resourceData\": {\n    \"@odata.type\": \"#Microsoft.Graph.Event\",\n    \"@odata.id\": \"Users/97e22591-9c20-4030-a11e-102ba89741fc/Events/AAMkADFlY2YyODZiLTc1OGItNGE1Yy1iNDI1LWNjMGQ5MDRjNDU2ZABGAAAAAACfo61cAY_iTZYbfhL-JgzZBwDlDV58cGeaS7ZJcZ6ff_AvAAAAAAENAADlDV58cGeaS7ZJcZ6ff_AvAAD9hgs0AAA=\",\n    \"@odata.etag\": \"W/\\\"DwAAABYAAADlDV58cGeaS7ZJcZ6ff+AvAAD9kqbB\\\"\",\n    \"id\": \"AAMkADFlY2YyODZiLTc1OGItNGE1Yy1iNDI1LWNjMGQ5MDRjNDU2ZABGAAAAAACfo61cAY_iTZYbfhL-JgzZBwDlDV58cGeaS7ZJcZ6ff_AvAAAAAAENAADlDV58cGeaS7ZJcZ6ff_AvAAD9hgs0AAA=\"\n  },\n  \"clientState\": \"…\"\n}\n</code></pre>\n",
  "link" : "https://stackoverflow.com/questions/44825976/microsoft-graph-sending-a-lot-of-unnecessary-notifications-for-create-delete",
  "owner" : {
    "user_id" : 938335,
    "user_type" : "registered",
    "display_name" : "Nexii Malthus",
    "profile_image" : "https://www.gravatar.com/avatar/271acfbd9dc26914e22bf25c51c617fd?s=128&d=identicon&r=PG",
    "link" : "https://stackoverflow.com/users/938335/nexii-malthus",
    "reputation" : 500,
    "accept_rate" : null
  },
  "is_answered" : false,
  "creation_date" : 1498741485,
  "last_activity_date" : 1498741485,
  "tags" : [
    "microsoftgraph",
    "ms-graph"
  ],
  "score" : 0,
  "view_count" : 3,
  "answer_count" : 0
}