{
  "question_id" : 44825865,
  "title" : "Inserting,displaying and deleting data using angular and php",
  "body" : "<p>I'm new to Angular and I'm trying to follow tutorial on angular and php (<a href=\"http://phpenthusiast.com/blog/ajax-with-angular-and-php\" rel=\"nofollow noreferrer\">http://phpenthusiast.com/blog/ajax-with-angular-and-php</a>).  I've managed to do the tutorial and now am trying to add a new field (testing). I've added a new field into the database.  For some reason this new input field is not working and I wonder why.  It displays the third input field, but when I try to add a person with 3rd value it is inserted as null in database.  Here is my code.</p>\n\n<p>index.html</p>\n\n<pre><code>&lt;!doctype html&gt;\n&lt;html ng-app=\"ajaxExample\"&gt;\n&lt;head lang=\"en\"&gt;\n    &lt;meta charset=\"utf-8\"&gt;\n    &lt;title&gt;Angular Ajax with PHP&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n\n&lt;h2&gt;The form&lt;/h2&gt;\n\n&lt;div ng-controller=\"mainController\"&gt;\n\n    &lt;form&gt; \n        &lt;p&gt;Fill the form&lt;/p&gt;\n        &lt;div&gt;\n            &lt;label&gt;Name&lt;/label&gt;\n            &lt;input type=\"text\" ng-model=\"newName\"&gt;\n        &lt;/div&gt;\n\n        &lt;div&gt;\n            &lt;label&gt;Phone&lt;/label&gt;\n            &lt;input type=\"text\" ng-model=\"newPhone\"&gt;\n        &lt;/div&gt;\n\n        &lt;div&gt;\n            &lt;label&gt;Tests&lt;/label&gt;\n            &lt;input type=\"text\" ng-model=\"newTesting\"&gt;\n        &lt;/div&gt;\n\n        &lt;input type=\"button\" value=\"Add\" ng-click=\"addPerson()\"&gt;\n\n    &lt;/form&gt;\n\n    &lt;h2&gt;The list&lt;/h2&gt;\n    &lt;p&gt;The names that were added with the form.&lt;/p&gt;\n\n    &lt;ul&gt;\n        &lt;li ng-repeat=\"person in people\"&gt;\n            &lt;button ng-click=\"deletePerson( person.id )\"&gt;Delete&lt;/button&gt; {{ person.name }} {{ person.phone }} {{ person.testing }}\n        &lt;/li&gt;\n    &lt;/ul&gt;\n\n&lt;/div&gt;\n\n&lt;script src=\"/libs/angular.min.js\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/js/app.js\"&gt;&lt;/script&gt;\n\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>app.js</p>\n\n<pre><code>var ajaxExample = angular.module('ajaxExample', []);\n\najaxExample.controller('mainController',function($scope,$http){\n    $scope.people;\n\n    $scope.getPeople = function() {\n          $http({\n\n              method: 'GET',\n              url: '/api/get.php'\n\n          }).then(function (response) {\n\n              // on success\n              $scope.people = response.data;\n\n          }, function (response) {\n\n              // on error\n              console.log(response.data,response.status);\n\n          });\n    };\n\n    $scope.addPerson = function() {\n          $http({\n\n               method: 'POST',\n               url:  '/api/post.php',\n               data: {newName: $scope.newName, newPhone: $scope.newPhone, newTest: $scope.newTest }\n\n          }).then(function (response) {// on success\n\n               $scope.getPeople();\n\n          }, function (response) {\n\n               console.log(response.data,response.status);\n\n          });\n    };\n\n    $scope.deletePerson = function( id ) {\n\n          $http({\n\n              method: 'POST',\n              url:  '/api/delete.php',\n              data: { recordId : id }\n\n          }).then(function (response) {\n\n              $scope.getPeople();\n\n          }, function (response) {\n\n              console.log(response.data,response.status);\n\n          });\n        };\n\n        $scope.getPeople();\n});\n</code></pre>\n\n<p>the database</p>\n\n<pre><code>CREATE TABLE IF NOT EXISTS `people` (\n  `id` int(10) NOT NULL AUTO_INCREMENT,\n  `name` varchar(60) DEFAULT NULL,\n  `phone` varchar(20) DEFAULT NULL,\n  `testing` INT(5),\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB  DEFAULT CHARSET=utf8;\n</code></pre>\n\n<p>connect.php - similar to one on tutorial with 'test' as database name\nget.php</p>\n\n<pre><code>&lt;?php\nrequire 'connect.php';\n\n$connect = connect();\n\n// Get the data\n$people = array();\n$sql = \"SELECT id, name, phone, testing FROM people\";\n\nif($result = mysqli_query($connect,$sql))\n{\n    $count = mysqli_num_rows($result);\n\n    $cr = 0;\n    while($row = mysqli_fetch_assoc($result))\n    {\n        $people[$cr]['id']    = $row['id'];\n        $people[$cr]['name']  = $row['name'];\n        $people[$cr]['phone'] = $row['phone'];\n        $people[$cr]['testing'] = $row['testing'];\n\n        $cr++;\n    }\n}\n\n$json = json_encode($people);\necho $json;\nexit;\n</code></pre>\n\n<p>post.php</p>\n\n<pre><code>&lt;?php\nrequire 'connect.php';\n\n$connect = connect();\n\n// Add the new data to the database.\n$postdata = file_get_contents(\"php://input\");\nvar_dump($postdata);\nif(isset($postdata) &amp;&amp; !empty($postdata))\n{\n    $request     = json_decode($postdata);\n\n    $newName  = preg_replace('/[^a-zA-Z ]/','',$request-&gt;newName);\n    $newPhone = preg_replace('/[^0-9 ]/','',$request-&gt;newPhone);\n    $newTesting = preg_replace('/[^0-9 ]/','',$request-&gt;newTesting);\n\n    if($newName  == '' || $newPhone == '') return;\n\n    $sql = \"INSERT INTO `people`(`name`, `phone`, `testing`) VALUES ('$newName','$newPhone', '$newTesting')\";\n\n    mysqli_query($connect,$sql);\n}\nexit;\n</code></pre>\n\n<p>delete.php - same as tutorial</p>\n\n<p>Thanks for help</p>\n",
  "link" : "https://stackoverflow.com/questions/44825865/inserting-displaying-and-deleting-data-using-angular-and-php",
  "owner" : {
    "user_id" : 127147,
    "user_type" : "registered",
    "display_name" : "niuchu",
    "profile_image" : "https://www.gravatar.com/avatar/72fbf06a11883e550e624a08fac17234?s=128&d=identicon&r=PG",
    "link" : "https://stackoverflow.com/users/127147/niuchu",
    "reputation" : 31,
    "accept_rate" : 33
  },
  "is_answered" : false,
  "creation_date" : 1498741214,
  "last_activity_date" : 1498741214,
  "tags" : [
    "php",
    "mysql",
    "angular"
  ],
  "score" : 0,
  "view_count" : 6,
  "answer_count" : 0
}