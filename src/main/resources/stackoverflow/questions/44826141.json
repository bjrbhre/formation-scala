{
  "question_id" : 44826141,
  "title" : "Zxing Scanner stuck after running once?",
  "body" : "<p>I am making QR scanner based android application that gets the data from QR code and send to server to check the data, but my scanner stuck after scanning an invalid QR code</p>\n\n<p>here's my code</p>\n\n<p><strong>Qrresult.java</strong></p>\n\n<pre><code> public class qrresult extends AppCompatActivity implements ZXingScannerView.ResultHandler {\n\n    private ZXingScannerView mScannerView;\n    private FocusHandler focusHandler;\n    public ImageButton back;\n\npublic void backbut() {\n    back = (ImageButton) findViewById(R.id.bckbut);\n    back.setOnClickListener(new View.OnClickListener() {\n        @Override\n        public void onClick(View v) {\n            //onBackPressed();\n            Intent back = new Intent(getApplicationContext(),mainmenu.class);\n            startActivity(back);\n        }\n    });\n     }\n\n    @Override\n    public void onCreate(Bundle state) {\n        super.onCreate(state);\n        setContentView(R.layout.activity_qrresult);\n        RelativeLayout zscanner = (RelativeLayout) findViewById(R.id.zxscan);\n        mScannerView = new ZXingScannerView(this);   // Programmatically initialize the scanner view\n\n        focusHandler = new FocusHandler(new Handler(), mScannerView);\n        zscanner.addView(mScannerView);\n        backbut();\n\n    }\n\n@Override\npublic void onResume() {\n    super.onResume();\n    mScannerView.setResultHandler(this); // Register ourselves as a handler for scan results.\n    mScannerView.setAutoFocus(false);\n    mScannerView.startCamera();\n    focusHandler.start();\n\n}\n\n@Override\npublic void onPause() {\n    super.onPause();\n    mScannerView.stopCamera();\n    focusHandler.stop(); //Stop camera on pause\n}\n@Override\npublic void onStop(){\n    super.onStop();\n    mScannerView.stopCamera();\n}\n@Override\npublic void handleResult(Result rawResult) {\n        // Do something with the result here\n        String qrdata= rawResult.getText();\n        qrresultWorker qrresultWorker= new qrresultWorker(this);\n        qrresultWorker.execute(qrdata);\n        //mScannerView.resumeCameraPreview(this);\n\n        // If you would like to resume scanning, call this method below:\n        //mScannerView.resumeCameraPreview(this);\n    }\n}\n</code></pre>\n\n<p><strong>QrresultWorker.java</strong></p>\n\n<pre><code> public class qrresultWorker extends AsyncTask&lt;String,Void,String&gt; {\n\n\n\nprivate Context context;\nprivate AlertDialog alertDialog;\nprivate ProgressDialog Asycdialog;\nqrresultWorker(Context ctx) {\n    context = ctx;\n}\n\n@Override\nprotected String doInBackground(String... params) {\n\n\n\n   String login_url = \"http://10.0.2.2/projects/dbcon1/qrresult.php\";\n\n\n        try {\n\n            //Used for Sending data to Database\n\n            String qrdata = params[0];\n            URL url = new URL(login_url);\n            HttpURLConnection httpURLConnection = (HttpURLConnection) url.openConnection();\n            httpURLConnection.setRequestMethod(\"POST\");\n            //httpURLConnection.setConnectTimeout(100000);\n            //httpURLConnection.setReadTimeout(100000);\n            httpURLConnection.setDoOutput(true);\n            httpURLConnection.setDoInput(true);\n            OutputStream outputStream = httpURLConnection.getOutputStream();\n            BufferedWriter bufferedWriter = new BufferedWriter(new OutputStreamWriter(outputStream, \"UTF-8\"));\n            String post_data = URLEncoder.encode(\"qrdata\", \"UTF-8\") + \"=\" + URLEncoder.encode(qrdata, \"UTF-8\");\n            bufferedWriter.write(post_data);\n            bufferedWriter.flush();\n            bufferedWriter.close();\n            outputStream.close();\n\n            //Used for Getting data from Database\n            InputStream inputStream = httpURLConnection.getInputStream();\n            BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(inputStream, \"iso-8859-1\"));\n            String result = \"\"; //initializing with empty string\n            String line = \"\";  //initializing with empty string\n            while ((line = bufferedReader.readLine()) != null) {\n                result += line;\n            }\n            bufferedReader.close();\n            inputStream.close();\n            httpURLConnection.disconnect();\n            return result;\n        } catch (IOException e) {\n            e.printStackTrace();\n        }\n\n    return null;\n}\n\n@Override\nprotected void onPreExecute() {\n    //progress dialog\n    //Asycdialog = new ProgressDialog(context);\n    //Asycdialog.setMessage(\"Scanning...\");\n    //Asycdialog.show();\n\n    //alertdialog\n    AlertDialog.Builder builder = new AlertDialog.Builder(context);\n    builder.setPositiveButton(\"Cancel\",\n            new DialogInterface.OnClickListener() {\n                public void onClick(DialogInterface dialog,\n                                    int id) {\n                    //Intent go = new Intent(context.getApplicationContext(),qrresult.class);\n                    //context.startActivity(go);\n                dialog.dismiss();\n\n                }\n           });\n    alertDialog = builder.create();\n    alertDialog.setTitle(\"Scan Status\");\n}\n\n@Override\nprotected void onPostExecute(String result) {\n    //Asycdialog.dismiss();\n\n    /*String name = null;\n    int balance = 0;\n    String qrcode=null;\n    JSONObject jsonResponse = null;\n    try {\n        jsonResponse = new JSONObject(result);\n    } catch (JSONException e) {\n        e.printStackTrace();\n    }\n*/\n    if (result.equals(\"success\")){\n\n        Intent intent = new Intent(context.getApplicationContext(),sendmoney.class);\n        context.startActivity(intent);\n\n    }\n    else {\n\n        Toast.makeText(context.getApplicationContext(),\"Coundn't scan the QR code\",Toast.LENGTH_SHORT).show();\n        //alertDialog.setMessage(\"Scanning Failed,Invalid Qrcode, please retry\");\n        //alertDialog.show();\n\n    }\n\n\n}\n\n@Override\nprotected void onProgressUpdate(Void... values) {\n    super.onProgressUpdate(values);\n}\n\n}\n</code></pre>\n",
  "link" : "https://stackoverflow.com/questions/44826141/zxing-scanner-stuck-after-running-once",
  "owner" : {
    "user_id" : 7873982,
    "user_type" : "registered",
    "display_name" : "Dragon Slayer",
    "profile_image" : "https://www.gravatar.com/avatar/83503bfe0be7be863754b5001e72e09e?s=128&d=identicon&r=PG&f=1",
    "link" : "https://stackoverflow.com/users/7873982/dragon-slayer",
    "reputation" : 3,
    "accept_rate" : null
  },
  "is_answered" : false,
  "creation_date" : 1498741948,
  "last_activity_date" : 1498743048,
  "tags" : [
    "java",
    "android",
    "qr-code",
    "zxing"
  ],
  "score" : 0,
  "view_count" : 13,
  "answer_count" : 1
}